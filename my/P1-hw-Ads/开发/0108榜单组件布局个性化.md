1. table

榜单排序暂存表 ads_noah_site_rank_dm

```mysql
create table if not exists biads.ads_noah_site_rank_dm
(oper_type string, 
 app_type varchar(256), 
 third_app_type varchar(256), 
 list_id string, 
 province string, 
 city string, 
 device_name string, 
 down_app_id_23day_list string, 
 down_app_type_23day_list string, 
 use_app_list_twoweek string, 
 clicknotdownload_app_id_list_twoweek string
)
comment '榜单排序暂存表'
partitioned by(pt_d STRING COMMENT '天分区')
row format delimited
fields terminated by '\001'
lines terminated by '\n'
stored as orc
location 'hdfs://hacluster/AppData/BIProd/ADS/AdsNoah/siterank/ads_noah_site_rank_dm'
tblproperties('orc.compress'='ZLIB');

set mapred.reduce.tasks=90;
insert overwrite table biads.ads_noah_site_rank_dm partition(pt_d='$date')
select 
oper_type, 
app_type, 
third_app_type, 
list_id, 
province, 
city, 
device_name, 
down_app_id_23day_list, 
down_app_type_23day_list, 
use_app_list_twoweek, 
clicknotdownload_app_id_list_twoweek
from biads.ads_noah_common_big_table_exposure_client_download_dm where pt_d='$date' and (list_id='2' or list_id='16' or list_id='cds111122701' or list_id='cds_111122760')
distribute by rand();
```





**疑问**

1. 需求？

   1. 精选tab页下
      1. 榜单个性化排序
   2. 分类tab页下
      1. 子tab个性化排序
      2. 子tab下榜单个性化排序

2. 非类目用前5的标签做标识，

3. 特征

   1. 设计方案的特征与实现不一致
   2. 没有用imei
   3. `down_app_id_23day_list-23天下载应用编号`和`down_app_type_23day_list` 基本为null

4. 

   

5. 类目特征如何组织？

6. 目录是否合理？例如BASE_DIR="/home/AdsNoah/mfsdir/siteRank"

7. 应该是if else？

   ![1578474775161](../../../../../projectdocsmyimages/1578474775161.png)

8. ![1578917484225](../../../../../projectdocsmyimages/1578917484225-1579595208448.png)

9. 为什么ftrl 每一个数据值定为一个特征，特征值为1 做训练，这样效果好吗？

10. ![1578925048547](../../../../../projectdocsmyimages/1578925048547-1579595210343.png)

    这两个分别是什么文件？

11. list_id 对应界面哪里？为什么要只要这些？

    ![1578969167028](../../../../../projectdocsmyimages/1578969167028-1579595211776.png)

    12. compentid，curr_tab，prev_tab，tags分别是啥，compentid为什么特地到DWD取，从来没有取到ADS



## 特征优化

@黄涛强 按照刚才说的，加三个特征，
1、用户X段时间对一个榜单的曝光次数
2、一个榜单内APP的曝光个数
3、一个榜单内APP的下载次数



1. 统计一周的